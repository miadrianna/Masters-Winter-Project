}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Ach <- read.csv("Yearly_Avg_Temp_Ach.csv")
data <- prev_calc(read.csv("Ach.Ao.Meta.csv"),Ach)
data2 <- prev_calc(read.csv("../Ao OW Data/Ach.Ao.OWL.csv"),Ach, development = "Tad")
points(Ach$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Ach$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Ach$Year){
lines(c(Ach[Ach$Year == i, "Avg_Temp"],Ach[Ach$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.13,"(c)",cex=1.4)
dev.off()
svg("Pui.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,6.7),mfrow=c(2,2))
plot(5:8,Pui.Ao[6:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(5:8,Pui.AoOW[6:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(5:8,Pui.AoOWL[6:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.15, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Pui <- read.csv("Yearly_Avg_Temp_Pui.csv")
data <- prev_calc(read.csv("Pui.Ao.Meta.csv"),Pui)
data2 <- prev_calc(read.csv("../Ao OW Data/Pui.Ao.OWL.csv"),Pui, development = "Tad")
points(Pui$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Pui$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Pui$Year){
lines(c(Pui[Pui$Year == i, "Avg_Temp"],Pui[Pui$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(5,1.13,"(d)",cex=1.4)
dev.off()
#Plot showing the relationship of Bd prevalece to spring onset in all lakes for metamorphs
svg("Arl.Meta.OW.Temp.svg", width=15,height=9)
par(xpd=TRUE,mar=c(4.8,4.9,3.2,7),mfrow=c(2,2))
plot(4:8,Arl.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Arl.Bs[5:9], col = colours[4], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.Rt[5:9], col = colours[5], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.18,1,legend = c("Ao","Ao.OW","Ao.OW L","Bs", "Rt"), fill = colours[1:5], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Arl <- read.csv("Yearly_Temp_Avg.csv")
data <- prev_calc(read.csv("Arl.Ao.Meta.csv"),Arl)
data2 <- prev_calc(read.csv("Arl.Bb.Meta.csv"),Arl)
data3 <- prev_calc(read.csv("Arl.Rt.Meta.csv"),Arl)
data4 <- prev_calc(read.csv("../Ao OW Data/Arl.Ao.OWL.csv"), Arl, development = "Tad")
points(Arl$Average.Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Arl$Average.Temp,data2$prevalence,col = colours[4],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data3$prevalence,col = colours[5],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data4$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Arl$Year){
lines(c(Arl[Arl$Year == i, "Average.Temp"],Arl[Arl$Year == i, "Average.Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.1,"(a)",cex=1.4)
dev.off()
#Plot showing the relationship of Bd prevalece to spring onset in all lakes for metamorphs
svg("Arl.Meta.OW.Temp.svg", width=15,height=9)
par(xpd=TRUE,mar=c(4.8,4.9,3.2,7),mfrow=c(2,2))
plot(4:8,Arl.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Arl.Bs[5:9], col = colours[4], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.Rt[5:9], col = colours[5], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.18,1,legend = c("Ao","Ao.OW","Ao.OW L","Bs", "Rt"), fill = colours[1:5], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Arl <- read.csv("Yearly_Temp_Avg.csv")
data <- prev_calc(read.csv("Arl.Ao.Meta.csv"),Arl)
data2 <- prev_calc(read.csv("Arl.Bb.Meta.csv"),Arl)
data3 <- prev_calc(read.csv("Arl.Rt.Meta.csv"),Arl)
data4 <- prev_calc(read.csv("../Ao OW Data/Arl.Ao.OWL.csv"), Arl, development = "Tad")
points(Arl$Average.Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Arl$Average.Temp,data2$prevalence,col = colours[4],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data3$prevalence,col = colours[5],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data4$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Arl$Year){
lines(c(Arl[Arl$Year == i, "Average.Temp"],Arl[Arl$Year == i, "Average.Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.1,"(a)",cex=1.4)
dev.off()
#################################################################################################################################################################################
svg("Ans.Meta.OW.Temp.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.2),mfrow=c(2,2))
plot(4:7,Ans.Ao[5:8], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:7,Ans.AoOW[5:8], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:7,Ans.AoOWL[5:8], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(7.14,1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Ans <- read.csv("Yearly_Avg_Temp_Ans.csv")
data <- prev_calc(read.csv("Ans.Ao.Meta.csv"),Ans)
data2 <- prev_calc(read.csv("../Ao OW Data/Ans.Ao.OWL.csv"),Ans,development = "Tad")
points(Ans$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Ans$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Ans$Year){
lines(c(Ans[Ans$Year == i, "Avg_Temp"],Ans[Ans$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.1,"(b)",cex=1.4)
dev.off()
###############################################################################################################################################################################
svg("Ach.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.2),mfrow=c(2,2))
plot(4:8,Ach.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Ach.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Ach.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.2, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Ach <- read.csv("Yearly_Avg_Temp_Ach.csv")
data <- prev_calc(read.csv("Ach.Ao.Meta.csv"),Ach)
data2 <- prev_calc(read.csv("../Ao OW Data/Ach.Ao.OWL.csv"),Ach, development = "Tad")
points(Ach$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Ach$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Ach$Year){
lines(c(Ach[Ach$Year == i, "Avg_Temp"],Ach[Ach$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.13,"(c)",cex=1.4)
dev.off()
###############################################################################################################################################################################
svg("Pui.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.2),mfrow=c(2,2))
plot(5:8,Pui.Ao[6:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(5:8,Pui.AoOW[6:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(5:8,Pui.AoOWL[6:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.15, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Pui <- read.csv("Yearly_Avg_Temp_Pui.csv")
data <- prev_calc(read.csv("Pui.Ao.Meta.csv"),Pui)
data2 <- prev_calc(read.csv("../Ao OW Data/Pui.Ao.OWL.csv"),Pui, development = "Tad")
points(Pui$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Pui$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Pui$Year){
lines(c(Pui[Pui$Year == i, "Avg_Temp"],Pui[Pui$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(5,1.13,"(d)",cex=1.4)
dev.off()
svg("Ach.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.3),mfrow=c(2,2))
plot(4:8,Ach.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Ach.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Ach.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.2, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Ach <- read.csv("Yearly_Avg_Temp_Ach.csv")
data <- prev_calc(read.csv("Ach.Ao.Meta.csv"),Ach)
data2 <- prev_calc(read.csv("../Ao OW Data/Ach.Ao.OWL.csv"),Ach, development = "Tad")
points(Ach$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Ach$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Ach$Year){
lines(c(Ach[Ach$Year == i, "Avg_Temp"],Ach[Ach$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.13,"(c)",cex=1.4)
dev.off()
########################################################################################################################################################################
#Plot showing the relationship of Bd prevalece to spring onset in all lakes for metamorphs
svg("Arl.Meta.OW.Temp.svg", width=15,height=9)
par(xpd=TRUE,mar=c(4.8,4.9,3.2,7.2),mfrow=c(2,2))
plot(4:8,Arl.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Arl.Bs[5:9], col = colours[4], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.Rt[5:9], col = colours[5], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.18,1,legend = c("Ao","Ao.OW","Ao.OW L","Bs", "Rt"), fill = colours[1:5], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Arl <- read.csv("Yearly_Temp_Avg.csv")
data <- prev_calc(read.csv("Arl.Ao.Meta.csv"),Arl)
data2 <- prev_calc(read.csv("Arl.Bb.Meta.csv"),Arl)
data3 <- prev_calc(read.csv("Arl.Rt.Meta.csv"),Arl)
data4 <- prev_calc(read.csv("../Ao OW Data/Arl.Ao.OWL.csv"), Arl, development = "Tad")
points(Arl$Average.Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Arl$Average.Temp,data2$prevalence,col = colours[4],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data3$prevalence,col = colours[5],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data4$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Arl$Year){
lines(c(Arl[Arl$Year == i, "Average.Temp"],Arl[Arl$Year == i, "Average.Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.1,"(a)",cex=1.4)
dev.off()
svg("Pui.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.3),mfrow=c(2,2))
plot(5:8,Pui.Ao[6:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(5:8,Pui.AoOW[6:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(5:8,Pui.AoOWL[6:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.15, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#prevalence
Pui <- read.csv("Yearly_Avg_Temp_Pui.csv")
data <- prev_calc(read.csv("Pui.Ao.Meta.csv"),Pui)
data2 <- prev_calc(read.csv("../Ao OW Data/Pui.Ao.OWL.csv"),Pui, development = "Tad")
points(Pui$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Pui$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
for(i in Pui$Year){
lines(c(Pui[Pui$Year == i, "Avg_Temp"],Pui[Pui$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(5,1.13,"(d)",cex=1.4)
dev.off()
library(adegenet)
library(multcomp)
#These colours make up the colour pallete used in the sunflower plots generated by this code
colours <- c("darkgreen","gold3","darkturquoise","deeppink","firebrick4","red","snow4","royalblue4", "orangered2","khaki3", "lightgoldenrod3","navy","slategray2")
#The initial part of the code specifies what parts need to be derived from the files down below.
#As you continue through the code the next parts are where the proportion of infected as well as the yearly average temperatures are paired with the corresponding years
#Also the data was converted into binary data of 0 and 1s and a binomial glm was run
Temperature_vs_prev <- function(infection, development = "Meta", temperature, years, test_against, name_of_file, size, xlim){
Arlet.Meta<- read.csv(infection, header = TRUE)
Date<- read.csv(temperature,header=TRUE, row.names=1)
#This was mainly for the purposes of making the graph as different GE thresholds were used there the default GE was 0.05 for metamorphs unless I specified 'Tad'
if(development == "Meta"){
Meta.prev<- unlist(lapply(unique(Arlet.Meta$Year), function(x) nrow(Arlet.Meta[(Arlet.Meta$GE > 0.05) & (Arlet.Meta$Year == x),])/nrow(Arlet.Meta[Arlet.Meta$Year == x,])))
Pos<- 1*(Arlet.Meta[Arlet.Meta$Year %in% years, "GE"]>0.05)
} else if (development == "Tad"){
Meta.prev<- unlist(lapply(unique(Arlet.Meta$Year), function(x) nrow(Arlet.Meta[(Arlet.Meta$GE > 10) & (Arlet.Meta$Year == x),])/nrow(Arlet.Meta[Arlet.Meta$Year == x,])))
Pos<- 1*(Arlet.Meta[Arlet.Meta$Year %in% years, "GE"]>10)
}
names(Meta.prev) <- unique(Arlet.Meta$Year)
Meta.prev<- Meta.prev[years]
Arl.date<- Date[years, , drop= TRUE ]
names(Arl.date)<- years
plot(Arl.date, Meta.prev, pch=20, cex=3)
Meta<- unlist(lapply(Arlet.Meta$Year, function(x) Arl.date[names(Arl.date) == x, drop = TRUE]))
Meta.glm<- glm(Pos~Meta, family = "binomial")
#These codes are the equations to test the strenght of the glm models and print them out as aprt of the summary of the model
R2 <- (Meta.glm$null.deviance - Meta.glm$deviance) / Meta.glm$null.deviance
chisq <- 1-pchisq(Meta.glm$deviance, Meta.glm$df.residual)
deviance<- with(Meta.glm, null.deviance-deviance)
residual<- with(Meta.glm, df.null-df.residual)
chisqnull<- with(Meta.glm, pchisq(null.deviance-deviance, df.null-df.residual, lower.tail = FALSE))
print(summary(Meta.glm))
print(paste("R2 is equal to",R2))
print(paste("chisq is equal to",chisq))
print(paste("null.deviance-deviance is equal to",deviance))
print(paste("df.null-df.residual is equal to", residual))
print(paste("chisq null is equal to", chisqnull))
#This is used to make the sunflower plots by taking the information from the model to create the bubbles with number of species infected/non-infected and the lines
pred.x <- data.frame(Meta=1:365)
class(pred.x)
pred.y <- predict(Meta.glm, newdata=pred.x, type="response")
class(pred.y)
temp <- xyTable(Pos~Meta)
temp
#This is where the colours are associated to each bubble
toto <- data.frame("data" = Date[years,], row.names = years)
toto
rownames(toto) <-colours[1:nrow(toto)]
bubcol <- rownames(toto)[match(round(temp$x,2), round(toto[,1],2))]
#This is the actual creation of the sunflower plot saved as an svg image
svg(name_of_file, width=9,height=6)
symbols(temp$x, temp$y, bg=transp(bubcol), circ=size*sqrt(temp$number), inches=FALSE, xlab=test_against, ylab="Presence of Bd", xlim=xlim)
text(temp$x, temp$y, label=temp$number)
abline(h=0:1, col=transp("grey"))
lines(pred.x$Meta, pred.y, lwd=2)
legend("right", fill=transp(rownames(toto)), legend=years, title="Year")
dev.off()
return(c(pred.x,pred.y)) #The reason for returning this is so smaller versions of the sunflower plots including both tadpoles and metamoprhs can be shown on one graph
}
#These are all the files which used the code above to give out a summary of the model as well as the summary for the strenght of the model and an svg plot which automatically gets saved in the folder rather than appear on R studio
#Alytes test - Average temperature - Arlet
Arl.Ao <- Temperature_vs_prev(infection = "Arl.Ao.Meta.csv", temperature = "Yearly_Temp_Avg.csv", years = c("2008", "2011", "2012", "2013", "2014", "2015", "2016","2017"), test_against = "Average yearly temperatures", name_of_file = "Arl.Ao.Temp.Avg.svg", size = 0.03, xlim = c(4,8))
#Bufo test - Average temperature - Arlet
Arl.Bs <- Temperature_vs_prev(infection = "Arl.Bb.Meta.csv", temperature = "Yearly_Temp_Avg.csv", years = c("2008","2011","2012","2013", "2017"), test_against = "Average yearly temperatures", name_of_file = "Arl.Bs.Temp.Avg.svg", size = 0.03, xlim = c(4,8))
#Rana test - Average temperature - Arlet
Arl.Rt <- Temperature_vs_prev(infection = "Arl.Rt.Meta.csv", temperature = "Yearly_Temp_Avg.csv", years = c("2008","2011","2012","2013", "2014", "2016", "2017"), test_against = "Average yearly temperatures", name_of_file = "Arl.Rt.Temp.Avg.svg", size = 0.03, xlim = c(4,8))
#Alytes OW tadpoles test - Arlet- For graph purposes
Arl.AoOW <-Temperature_vs_prev(infection = "../Ao OW Data/Arl.Ao.OWL.csv",temperature = "../Ao OW Data/Yearly_Avg_Temp_ Arl.csv", development = "Tad", years = c("2008", "2011", "2012", "2013", "2016"), test_against = "Yearly averages temperatures", name_of_file = "Arl.Ao.OW.Avg.svg", size = 0.05, xlim = c(4,8))
#Alytes OW tadpoles test- Arlet with lag - For graph purposes
Arl.AoOWL <- Temperature_vs_prev(infection = "../Ao OW Data/Arl.Ao.OWL_Lag.csv", temperature = "../Ao OW Data/Yearly_Avg_Temp_ Arl_Lag.csv", development = "Tad", years = c("2011", "2012", "2013", "2016"), test_against = "Yearly averages temperatures", name_of_file = "Arl.Ao.OW.Avg.Lag.svg", size = 0.05, xlim = c(1,8))
#Alytes test - Variance - Arlet
Temperature_vs_prev(infection = "Arl.Ao.Meta.csv", temperature = "Variance.csv", years = c("2008", "2011", "2012", "2013", "2014", "2015", "2016","2017"), test_against = "Temperature Variance", name_of_file = "Arl.Ao.Var.svg", size = 0.2, xlim = c(40,70))
#Bufo test - Variance - Arlet
Temperature_vs_prev(infection = "Arl.Bb.Meta.csv", temperature = "Variance.csv", years = c("2008","2011","2012","2013", "2017"), test_against = "Temperature Variance", name_of_file = "Arl.Bs.Var.svg", size = 0.4, xlim = c(40,70))
#Rana test - Variance - Arlet
Temperature_vs_prev(infection = "Arl.Rt.Meta.csv", temperature = "Variance.csv", years = c("2008","2011","2012","2013", "2014", "2016", "2017"), test_against = "Temperature Variance", name_of_file = "Arl.Rt.Var.svg", size = 0.3, xlim = c(40,70))
#Alytes test - Minimum temperature - Arlet
Temperature_vs_prev(infection = "Arl.Ao.Meta.csv", temperature = "Yearly Minimum Temperature.csv", years = c("2008", "2011", "2012", "2013", "2014", "2015", "2016","2017"), test_against = "Average minimum temperatures", name_of_file = "Arl.Ao.Temp.Min.svg", size = 0.03, xlim = c(4,8))
#Bufo test - Minimum temperature - Arlet
Temperature_vs_prev(infection = "Arl.Bb.Meta.csv", temperature = "Yearly Minimum Temperature.csv", years = c("2008","2011","2012","2013","2017"), test_against = "Average minimum temperatures", name_of_file = "Arl.Bs.Temp.Min.svg", size = 0.04, xlim = c(4,8))
#Rana test - Minimum temperature - Arlet
Temperature_vs_prev(infection = "Arl.Rt.Meta.csv", temperature = "Yearly Minimum Temperature.csv", years = c("2008","2011","2012","2013", "2014", "2016", "2017"), test_against = "Average minimum temperatures", name_of_file = "Arl.Rt.Temp.Min.svg", size = 0.03, xlim = c(4,8))
#Alytes test - Maximum temperature - Arlet
Temperature_vs_prev(infection = "Arl.Ao.Meta.csv", temperature = "Maximum_Temp.csv", years = c("2008", "2011", "2012", "2013", "2014", "2015", "2016","2017"), test_against = "Average maximum temperatures", name_of_file = "Arl.Ao.Temp.Max.svg", size = 0.03, xlim = c(5,9))
#Bufo test - Maximum temperature - Arlet
Temperature_vs_prev(infection = "Arl.Bb.Meta.csv", temperature = "Maximum_Temp.csv", years = c("2008","2011","2012","2013", "2017"), test_against = "Average maximum temperatures", name_of_file = "Arl.Bs.Temp.Max.svg", size = 0.03, xlim = c(5,9))
#Rana test - Maximum temperature - Arlet
Temperature_vs_prev(infection = "Arl.Rt.Meta.csv", temperature = "Maximum_Temp.csv", years = c("2008","2011","2012","2013", "2014", "2016", "2017"), test_against = "Average maximum temperatures", name_of_file = "Arl.Rt.Temp.Max.svg", size = 0.03, xlim = c(5,9))
#Alytes test - Average temperature - Acherito
Ach.Ao <- Temperature_vs_prev(infection = "Ach.Ao.Meta.csv", temperature = "Yearly_Avg_Temp_Ach.csv",years = c("2008", "2009", "2010","2014", "2015", "2016", "2017"), test_against = "Average yearly temperatures", name_of_file = "Ach.Ao.Temp.Avg.svg", size = 0.04, xlim = c(4,8))
#Alytes OW tadpoles test - Acherito - For graph purposes
Ach.AoOW<- Temperature_vs_prev(infection = "../Ao OW Data/Ach.Ao.OWL.csv", temperature = "../Ao OW Data/Yearly_Avg_Temp_Ach.csv", development = "Tad", years = c("2009","2011", "2014", "2017"), test_against = "Yearly averages temperatures", name_of_file = "Ach.Ao.OW.Avg.svg", size = 0.03, xlim = c(5,9))
#Alytes OW tadpoles test - Acherito-Lag - For graph purposes
Ach.AoOWL <- Temperature_vs_prev(infection = "../Ao OW Data/Ach.Ao.OWL.csv", temperature = "../Ao OW Data/Yearly_Avg_Temp_Ach_Lag.csv", development = "Tad",years = c("2009","2011", "2014", "2017"), test_against = "Yearly averages temperatures", name_of_file = "Ach.Ao.OW.Avg.Lag.svg", size = 0.05, xlim = c(4,10))
#Alytes test - Average temperature - Ansabere
Ans.Ao <- Temperature_vs_prev(infection = "Ans.Ao.Meta.csv", temperature = "Yearly_Avg_Temp_Ans.csv", years = c("2010", "2011", "2015", "2016"), test_against = "Average yearly temperatures", name_of_file = "Ans.Ao.Temp.Avg.svg", size = 0.04, xlim = c(4,8))
#Alytes OW tadpoles test - Ansabere-For graph purposes
Ans.AoOW<- Temperature_vs_prev(infection = "../Ao OW Data/Ans.Ao.OWL.csv", development = "Tad", temperature = "../Ao OW Data/Yearly_Avg_Temp_Ans.csv", years = c("2008", "2009","2011", "2014", "2016"), test_against = "Yearly averages temperatures", name_of_file = "Ans.Ao.OW.Avg.svg", size = 0.03, xlim = c(4,8))
#Alytes OW tadpoles test - Ansabere-Lag- For graph purposes
Ans.AoOWL <- Temperature_vs_prev(infection = "../Ao OW Data/Ans.Ao.OWL.csv", temperature = "../Ao OW Data/Yearly_Avg_Temp_Ans_Lag.csv", development = "Tad", years = c("2009", "2011","2014", "2016"), test_against = "Yearly averages temperatures", name_of_file = "Ans.Ao.OW.Avg.Lag.svg", size = 0.04, xlim = c(4,9))
#Alytes test - Average temperature - Puits
Pui.Ao <- Temperature_vs_prev(infection = "Pui.Ao.Meta.csv", temperature = "Yearly_Avg_Temp_Pui.csv", years = c("2008", "2010", "2014", "2015", "2016", "2017"), test_against = "Average yearly temperatures", name_of_file = "Pui.Ao.Temp.Avg.svg", size = 0.04, xlim = c(5,8))
#Alytes OW tadpoles test - Puits - For graph purposes
Pui.AoOW<- Temperature_vs_prev(infection = "../Ao OW Data/Pui.Ao.OWL.csv", temperature = "../Ao OW Data/Yearly_Avg_Temp_Pui.csv", development = "Tad", years = c("2008", "2009", "2010","2014", "2016"), test_against = "Yearly averages temperatures", name_of_file = "Pui.Ao.OW.Avg.svg", size = 0.02, xlim = c(5,7))
#Alytes OW tadpoles test - Puits-Lag - For graph purposes
Pui.AoOWL <- Temperature_vs_prev(infection = "../Ao OW Data/Pui.Ao.OWL.csv", temperature = "../Ao OW Data/Yearly_Avg_Temp_Pui_Lag.csv", development = "Tad",years = c("2009", "2010","2014", "2016"), test_against = "Yearly averages temperatures", name_of_file = "Pui.Ao.OW.Avg.Lag.svg", size = 0.04, xlim = c(5,8))
########################################################################################################################################################################
#Plot showing the relationship of Bd prevalence and average yearly temperatures in Lac Arlet for all metamorphs and tadpoles
#Specifically this first part is to create the lines on the graph
svg("Arl.Meta.OW.Temp.svg", width=15,height=9)
par(xpd=TRUE,mar=c(4.8,4.9,3.2,7.2),mfrow=c(2,2))
plot(4:8,Arl.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Arl.Bs[5:9], col = colours[4], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.Rt[5:9], col = colours[5], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Arl.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.18,1,legend = c("Ao","Ao.OW","Ao.OW L","Bs", "Rt"), fill = colours[1:5], cex = 1.2)
#This function is so that the GE for metamorphs and tadpoles is different
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#This is just taking the prevalence from all the files so that points will appear corresponding to the average temperatures that year
Arl <- read.csv("Yearly_Temp_Avg.csv")
data <- prev_calc(read.csv("Arl.Ao.Meta.csv"),Arl)
data2 <- prev_calc(read.csv("Arl.Bb.Meta.csv"),Arl)
data3 <- prev_calc(read.csv("Arl.Rt.Meta.csv"),Arl)
data4 <- prev_calc(read.csv("../Ao OW Data/Arl.Ao.OWL.csv"), Arl, development = "Tad")
points(Arl$Average.Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Arl$Average.Temp,data2$prevalence,col = colours[4],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data3$prevalence,col = colours[5],pch= 16, cex = 1.5)
points(Arl$Average.Temp,data4$prevalence,col = colours[2],pch= 16, cex = 1.5)
#This function just creates vertical lines so that the years corresponding with spring onset can be shown
for(i in Arl$Year){
lines(c(Arl[Arl$Year == i, "Average.Temp"],Arl[Arl$Year == i, "Average.Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.1,"(a)",cex=1.4)
dev.off()
#################################################################################################################################################################################
#Plot showing the relationship of Bd prevalence and average yearly temperatures in Lac Ansabere for all metamorphs and tadpoles
#Specifically this first part is to create the lines on the graph
svg("Ans.Meta.OW.Temp.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.2),mfrow=c(2,2))
plot(4:7,Ans.Ao[5:8], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:7,Ans.AoOW[5:8], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:7,Ans.AoOWL[5:8], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(7.14,1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
#This function is so that the GE  for metamorphs and tadpoles is different
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#This is just taking the prevalence from all the files so that points will appear corresponding to the average temperatures for that year
Ans <- read.csv("Yearly_Avg_Temp_Ans.csv")
data <- prev_calc(read.csv("Ans.Ao.Meta.csv"),Ans)
data2 <- prev_calc(read.csv("../Ao OW Data/Ans.Ao.OWL.csv"),Ans,development = "Tad")
points(Ans$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Ans$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
#This function just creates vertical lines so that the years corresponding with spring onset can be shown
for(i in Ans$Year){
lines(c(Ans[Ans$Year == i, "Avg_Temp"],Ans[Ans$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.1,"(b)",cex=1.4)
dev.off()
###############################################################################################################################################################################
#Plot showing the relationship of Bd prevalence and average yearly temperatures in Lac Acherito for all metamorphs and tadpoles
#Specifically this first part is to create the lines on the graph
svg("Ach.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.3),mfrow=c(2,2))
plot(4:8,Ach.Ao[5:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(4:8,Ach.AoOW[5:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(4:8,Ach.AoOWL[5:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.2, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
#This function is so that the GE for metamorphs and tadpoles is different
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#This is just taking the prevalence from all the files so that points will appear corresponding to the average temperatures for that year
Ach <- read.csv("Yearly_Avg_Temp_Ach.csv")
data <- prev_calc(read.csv("Ach.Ao.Meta.csv"),Ach)
data2 <- prev_calc(read.csv("../Ao OW Data/Ach.Ao.OWL.csv"),Ach, development = "Tad")
points(Ach$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Ach$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
#This function just creates vertical lines so that the years corresponding with spring onset can be shown
for(i in Ach$Year){
lines(c(Ach[Ach$Year == i, "Avg_Temp"],Ach[Ach$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(4,1.13,"(c)",cex=1.4)
dev.off()
###############################################################################################################################################################################
#Plot showing the relationship of Bd prevalence and average yearly temperatures in Lac Puits d'Arious for all metamorphs and tadpoles
#Specifically this first part is to create the lines on the graph
svg("Pui.Meta.OW.Spring.svg", width=15,height=9)
par(xpd=TRUE,mar=c(5.3,4.4,2.8,7.3),mfrow=c(2,2))
plot(5:8,Pui.Ao[6:9], col = colours[1],type = "l", pch = 21, cex.lab = 1.7,cex.axis=1.7,cex.sub=1.7, lty = 1, ylim = c(0,1), lwd = 3, xlab="Yearly average temperatures", ylab = "Prevalence of Bd")#xlim= c(100, 190)
lines(5:8,Pui.AoOW[6:9], col = colours[2], pch = 21, cex = 1.5, lty = 1, lwd = 3)
lines(5:8,Pui.AoOWL[6:9], col = colours[3], pch = 21, cex = 1.5, lty = 1, lwd = 3)
legend(8.15, 1,legend = c("Ao","Ao.OW", "Ao.OW L"), fill = colours[1:3], cex = 1.2)
#This function is so that the GE for metamorphs and tadpoles is different
prev_calc <- function(x,y,development = "Meta"){
if(development=="Meta"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 0.05,])/nrow(x[x$Year == i,])))
}else if(development=="Tad"){
prev <- unlist(lapply(unique(y$Year), function(i) nrow(x[x$Year == i & x$GE >= 10,])/nrow(x[x$Year == i,])))
}
df <- data.frame("Year"=unique(y$Year), "prevalence"=prev)
return(df)
}
#This is just taking the prevalence from all the files so that points will appear corresponding to the average temperatures for that year
Pui <- read.csv("Yearly_Avg_Temp_Pui.csv")
data <- prev_calc(read.csv("Pui.Ao.Meta.csv"),Pui)
data2 <- prev_calc(read.csv("../Ao OW Data/Pui.Ao.OWL.csv"),Pui, development = "Tad")
points(Pui$Avg_Temp,data$prevalence,col = colours[1], pch= 16, cex = 1.5)
points(Pui$Avg_Temp,data2$prevalence,col = colours[2],pch= 16, cex = 1.5)
#This function just creates vertical lines so that the years corresponding with spring onset can be shown
for(i in Pui$Year){
lines(c(Pui[Pui$Year == i, "Avg_Temp"],Pui[Pui$Year == i, "Avg_Temp"]), c(0,1), col = "grey", lwd = 2, lty = 2)
}
text(5,1.13,"(d)",cex=1.4)
dev.off()
